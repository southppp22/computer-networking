# 3. 전송 계층

애플리케이션 프로세스 간의 **논리적 통신**은 **트랜스포트 계층**이 제공하는 주요 기능

- **프로세스 간 커뮤니케이션**: 서로 다른 호스트의 애플리케이션이 데이터를 주고받을 수 있도록 연결

---

## **트랜스포트 계층의 전송 단위: 세그먼트**

트랜스포트 계층은 데이터를 **세그먼트(segment)** 단위로 전송

- **Header**: 전송 정보를 포함 (e.g., source port, destination port, checksum).
- **Payload**: 실제 데이터.

---

## **Multiplexing (다중화)**

**트랜스포트 계층 세그먼트**의 데이터를 **네트워크 계층**으로 전달하는 작업.

- 송신 측에서 여러 애플리케이션의 데이터를 하나의 트랜스포트 계층으로 결합.
- 각 데이터에 **소스 포트**와 **목적지 포트**를 추가하여 애플리케이션을 식별.

---

## **Demultiplexing (역다중화)**

**트랜스포트 계층 세그먼트**의 데이터를 올바른 소켓으로 전달하는 작업.

- 수신 측에서 도착한 세그먼트를 분석.
- **목적지 포트 번호**를 기반으로 해당 데이터를 올바른 애플리케이션 프로세스에 전달.

---

## **Principle of Reliable Data Transfer**

신뢰적 데이터 전송은 데이터를 **유실 없이**, **오류 없이** 전달하는 것

- **특징**:  
  하위 네트워크 계층은 신뢰적 전송을 보장하지 않지만, **전송 계층 프로토콜**은 이를 사용자에게 신뢰적처럼 보이게 만듦
  - **Error Detection**
  - **Feedback**
  - **Sequence Number**
  - **Timer**

---

## **신뢰적 데이터 전송 프로토콜의 필수 요소**

1. **Error Detection**
   - 데이터 전송 중 발생한 오류를 탐지 (e.g., checksum 사용).
2. **Feedback**

   - 전송 성공 여부를 송신자에게 알림 (e.g., ACK 또는 NAK 사용).

3. **Sequence Number**

   - 데이터의 중복 또는 혼동을 방지하기 위해 각 데이터에 번호를 부여하여 추적.

4. **Timer**
   - 일정 시간 안에 Feedback을 받지 못할 경우 데이터 재전송 처리.

---

## **하위 네트워크 계층의 문제 해결 메커니즘**

1. **Error Handling (에러 처리)**

   - **Error Detection**: checksum을 사용하여 데이터에 오류가 있는지 확인.
   - **Feedback Mechanism**:
     - **ACK**: 데이터가 정상적으로 수신되었음을 알림.
     - **NAK**: 데이터에 오류가 발생했음을 알림.
   - 또는 **ACK + Sequence Number** 방식으로 NAK 없이 오류를 처리.

2. **Message Loss Handling (메시지 유실 처리)**
   - 송신자가 데이터를 전송한 뒤 일정 시간 안에 Feedback(ACK/NAK)을 받지 못하면 **Timer**를 이용해 데이터를 재전송.

---

## **UDP (User Datagram Protocol)**

**비연결형 프로토콜**로, 데이터 전송 전에 연결을 설정하지 않고 간단히 데이터를 주고받는 방식

### **다중화와 역다중화**

- **IP 주소**와 **포트 번호**를 사용하여 소켓을 식별하고 데이터를 적절한 애플리케이션으로 전달

### **Segment Header (세그먼트 헤더 구조)**

- **Source Port (16bit)**: 송신 측 포트 번호
- **Destination Port (16bit)**: 수신 측 포트 번호
- **Length (16bit)**: UDP 세그먼트의 총 길이 (바이트 단위)
- **Checksum (16bit)**: 데이터 무결성을 보장하기 위한 오류 검출 필드

### **Features (특징)**

1. **No Connection Establishment**: 연결 설정 과정이 없어 지연 시간이 적음.
2. **Simple**: 송신자와 수신자는 연결 상태(connection state)를 유지하지 않음.
3. **Small Header Size**: 헤더가 간단하여 오버헤드가 적음.
4. **No Congestion Control**: 네트워크 혼잡 제어가 없으므로 원하는 속도로 데이터를 전송 가능.
   - 단, 네트워크 혼잡 시 데이터 손실 가능성이 있음.

---

## **TCP (Transmission Control Protocol)**

**연결형 프로토콜**로, 데이터 전송 전 연결을 설정하며 신뢰성 있는 전송을 보장

### **다중화와 역다중화**

- **소켓의 고유 식별자**를 사용
- 소켓 식별자는 다음 4가지 정보로 구성
  - **Source IP**: 송신 측 IP 주소
  - **Source Port**: 송신 측 포트 번호
  - **Destination IP**: 수신 측 IP 주소
  - **Destination Port**: 수신 측 포트 번호

TCP는 이 정보를 기반으로 다중화와 역다중화를 처리합니다.
